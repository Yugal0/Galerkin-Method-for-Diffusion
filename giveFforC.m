function [Fval, gradFvsC] = giveFforC(C,profile,paramStruct)    
        
        % relativePath = fullfile('VarDi','Codes & Results','Codes','System Parameters','DvsCdata.mat');
        % data=load(relativePath);
        if(profile == "nmc811AMIDR")
            Dnmcdata=[1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.97000000000000e-15	1.95871794871795e-15	1.93246153846154e-15	1.88057988240542e-15	1.82604733885277e-15	1.77151479530013e-15	1.75000000000000e-15	1.75000000000000e-15	1.75000000000000e-15	1.75000000000000e-15	1.75000000000000e-15	1.75000000000000e-15	1.72415384688095e-15	1.69039560607239e-15	1.67443076940527e-15	1.66000000000000e-15	1.66000000000000e-15	1.65677948731521e-15	1.64627692279901e-15	1.64000000000000e-15	1.64000000000000e-15	1.62076923231769e-15	1.54199999982496e-15	1.46323076733223e-15	1.36872435659487e-15	1.27354486941539e-15	1.17836538223590e-15	1.09518090133021e-15	1.01315225578639e-15	9.31123610242575e-16	8.60628439783704e-16	8.28643358007756e-16	7.96658276231807e-16	7.64673194455859e-16	7.33874938039106e-16	7.30825806467350e-16	7.27776674895595e-16	7.24727543323840e-16	7.15605591488646e-16	6.54977154345584e-16	5.94348717202522e-16	5.33720280059460e-16	4.73091842916398e-16	4.45872820826228e-16	4.21716923073207e-16	3.97561025320186e-16	3.70044377402405e-16	3.14602958123884e-16	2.59161538845363e-16	2.03720119566843e-16	1.66534850545147e-16	1.33725753836087e-16	1.00916657127028e-16	8.67230773551425e-17	7.49076925607793e-17	6.30923077664160e-17	5.12769229720528e-17	3.94615381776896e-17	2.76461533833264e-17	1.92000000000000e-17	1.92000000000000e-17	1.92000000000000e-17	1.92000000000000e-17	1.92000000000000e-17	1.92000000000000e-17	1.92000000000000e-17	1.92000000000000e-17];
            
            % Cnmcdata=[0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0982602895747188	0.0966620925170971	0.0940268102842962	0.0903837513442488	0.0877844468481583	0.0875000000000000	0.0875000000000000	0.0875000000000000	0.0875000000000000	0.0875000000000000	0.0875000000000000	0.0865120468438042	0.0845128637036010	0.0834606724630835	0.0830000000000000	0.0830000000000000	0.0829305627847790	0.0822336708860056	0.0820000000000000	0.0820000000000000	0.0818137252612651	0.0782256061289595	0.0731783205769794	0.0685761560628738	0.0636399905030992	0.0588910009414959	0.0542943352818779	0.0496698142252217	0.0456599695454965	0.0428665863820978	0.0406500711221169	0.0387451138019948	0.0373566096857811	0.0366888418870313	0.0364990904507908	0.0363992639155758	0.0362891493973788	0.0360518739959619	0.0341099813947193	0.0304543555444938	0.0264727706093688	0.0235530007534274	0.0221073947502750	0.0210805642065408	0.0200534202568319	0.0186077280086116	0.0160769902642788	0.0129027831815287	0.0100737874804356	0.00803809545857930	0.00627359964998410	0.00496919623143369	0.00405329360963773	0.00319643199804806	0.00242966663856083	0.00178834794719121	0.00130782633995438	0.00102345223286555	0.000960000000000000	0.000960000000000000	0.000960000000000000	0.000960000000000000	0.000960000000000000	0.000960000000000000	0.000960000000000000	0.000960000000000000];
            Cdataspacing=0.01;
            Dnmcdata=Dnmcdata/paramStruct.D0;
            Fval = interp1(0:Cdataspacing:1,Dnmcdata,C,"pchip");
            gradFvsC = interp1(0:Cdataspacing:1,gradient(Dnmcdata,Cdataspacing),C,"pchip");
        
        elseif(profile == "nmc811AMIDRReversed")
            Cnmcdata=[0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0985000000000000	0.0982602895747188	0.0966620925170971	0.0940268102842962	0.0903837513442488	0.0877844468481583	0.0875000000000000	0.0875000000000000	0.0875000000000000	0.0875000000000000	0.0875000000000000	0.0875000000000000	0.0865120468438042	0.0845128637036010	0.0834606724630835	0.0830000000000000	0.0830000000000000	0.0829305627847790	0.0822336708860056	0.0820000000000000	0.0820000000000000	0.0818137252612651	0.0782256061289595	0.0731783205769794	0.0685761560628738	0.0636399905030992	0.0588910009414959	0.0542943352818779	0.0496698142252217	0.0456599695454965	0.0428665863820978	0.0406500711221169	0.0387451138019948	0.0373566096857811	0.0366888418870313	0.0364990904507908	0.0363992639155758	0.0362891493973788	0.0360518739959619	0.0341099813947193	0.0304543555444938	0.0264727706093688	0.0235530007534274	0.0221073947502750	0.0210805642065408	0.0200534202568319	0.0186077280086116	0.0160769902642788	0.0129027831815287	0.0100737874804356	0.00803809545857930	0.00627359964998410	0.00496919623143369	0.00405329360963773	0.00319643199804806	0.00242966663856083	0.00178834794719121	0.00130782633995438	0.00102345223286555	0.000960000000000000	0.000960000000000000	0.000960000000000000	0.000960000000000000	0.000960000000000000	0.000960000000000000	0.000960000000000000	0.000960000000000000];
            Cdataspacing=0.01;
            Fval = interp1(0:Cdataspacing:1,Cnmcdata,1-C,"pchip");
            gradFvsC = interp1(0:Cdataspacing:1,gradient(Cnmcdata,Cdataspacing),1-C,"pchip");
        

        elseif(profile == "nmc811AMIDRFitted")
            a=0.0990;
            b=-11.1601;
            c=0.6432;
            Fval=0.001+a./(1+exp(-b.*(C-c)));
            gradFvsC=-(a*b*exp((-b*(C - c))))/(exp((-b*(C - c))) + 1)^2;
        
        elseif(profile == "nmc811AMIDRFitted2")
            a=3.0295;
            b=10.9872;
            c=0.7689;
            d=1.0212;
            Fval=10^-(d+(a-d)*exp(-exp(-b*(C-c))));
            gradFvsC=-(1/10^(d + exp((-exp((-b*(C - c)))))*(a - d)))*b*exp((-exp((-b*(C - c)))))*exp((-b*(C - c)))*log(10)*(a - d);

        elseif(profile == "nmc811AMIDRFitted3")
            a=0.0990;
            b=-11.1601;
            c=0.6432;
            p1 =-142.9528;    
            p2 =465.4234;    
            p3 =-585.0869 ;   
            p4 =360.8261 ;    
            p5 =-113.9182 ;   
            p6 =17.3220   ;   
            p7 =-0.0362   ;    
            p8 =0.0129   ;
            % if(C>1)
            %     Fval=0.001;
            %     gradFvsC=0;
            % else
                Cstar = p1*C.^7 + p2*C.^6 + p3*C.^5 + p4*C.^4 + p5*C.^3 + p6*C.^2 + p7*C + p8;
                Fval=0.001+a./(1+exp(-b.*(Cstar-c)));
                gradFvsC=(a*b*exp(-b*(p1*C^7 + p2*C^6 + p3*C^5 + p4*C^4 + p5*C^3 + p6*C^2 + p7*C - c + p8))*(7*p1*C^6 + 6*p2*C^5 + 5*p3*C^4 + 4*p4*C^3 + 3*p5*C^2 + 2*p6*C + p7))/(exp(-b*(p1*C^7 + p2*C^6 + p3*C^5 + p4*C^4 + p5*C^3 + p6*C^2 + p7*C - c + p8)) + 1)^2;
            % end

        elseif(profile == "nmc811AMIDRFitted4")
            a=0.0990;
            b=-11.1601;
            c=0.6432;
            p1 =-142.9528;    
            p2 =465.4234;    
            p3 =-585.0869 ;   
            p4 =360.8261 ;    
            p5 =-113.9182 ;   
            p6 =17.3220   ;   
            p7 =-0.0362   ;    
            p8 =0.0129   ;
            if(C>1)
                Fval=0.001;
                gradFvsC=0;
            else
                Cstar = p1*C.^7 + p2*C.^6 + p3*C.^5 + p4*C.^4 + p5*C.^3 + p6*C.^2 + p7*C + p8;
                Fval=0.001+a./(1+exp(-b.*(Cstar-c)));
                gradFvsC=(a*b*exp(-b*(p1*C.^7 + p2*C.^6 + p3*C.^5 + p4*C.^4 + p5*C.^3 + p6*C.^2 + p7*C - c + p8))*(7*p1*C.^6 + 6*p2*C.^5 + 5*p3*C.^4 + 4*p4*C.^3 + 3*p5*C^2 + 2*p6*C + p7))/(exp(-b*(p1*C^7 + p2*C^6 + p3*C^5 + p4*C^4 + p5*C^3 + p6*C^2 + p7*C - c + p8)) + 1)^2;
            end
        elseif(profile=="nmc811AMIDRFitted5")
            a=0.1008;
            b=-8.2105;
            c=0.6986 ;
            d=0.0009;
            Fval = d + (a-d)*exp(-exp(-b*(C-c)));
            gradFvsC = b*exp(-exp(-b*(C - c)))*exp(-b*(C - c))*(a - d);


        elseif(profile == "sigmoid1")
            a=0.099;
            b=2;
            c=10;
            d=5;
            e=3;
            f=0.001;
            Fval=a/(1+exp(-b*log(c)*(d*(1-C)-e)))+f;
            gradFvsC=-(a*b*d*exp((b*log(c)*(e + d*(C - 1))))*log(c))/(exp(b*log(c)*(e + d*(C - 1))) + 1)^2;
        
        elseif(profile == "sigmoid2")
            a=0.099;
            b=2;
            c=10;
            d=5;
            e=4;
            f=0.001;
            Fval=a/(1+exp(-b*log(c)*(d*(1-C)-e)))+f;
            gradFvsC=-(a*b*d*exp((b*log(c)*(e + d*(C - 1))))*log(c))/(exp(b*log(c)*(e + d*(C - 1))) + 1)^2;

        elseif(profile == "const")
            Fval=1*paramStruct.D0multiplier;
            gradFvsC=0;
        
        elseif(profile == "thiagConst")
            Fval=1;
            gradFvsC=0;

        elseif(profile == "thiag")
            Fval=1/(3-2*C);
            gradFvsC=2/(3-2*C)^2;

        elseif(profile == "simplePoly")
            Fval=0.1*(1-0.9*C^2);
            gradFvsC=2*0.9*0.1*C;

        elseif(profile == "tanh")
            Fval=(0.501+0.5*tanh(100*(C-0.8)));
            gradFvsC= (50 - 50*tanh(100*C - 80)^2);

        elseif(profile == "nmcAMIDRFittedPoly")
            p1=-3.1302;
            p2=9.2325;
            p3=-9.3898;
            p4=3.8353;
            p5=-0.6944;
            p6=0.0494;
            p7=0.0977;

            Fval=p1*x^6 + p2*x^5 + p3*x^4 + p4*x^3 + p5*x^2 + p6*x + p7;
            gradFvsC=6*p1*x^5 + 5*p2*x^4 + 4*p3*x^3 + 3*p4*x^2 + 2*p5*x + p6;

        elseif(profile == "thiagReversed")
            Fval=1/(3-2*(1-C));
            gradFvsC=2/(3-2*(1-C))^2;

        elseif(profile == "thiagNew")
            Fval=(1/(3-2*C))^3;
            gradFvsC=(3*(1/(3-2*C)^2))*(2/(3-2*C)^2);
        
        elseif(profile == "linear")
            Fval=0.01+C*0.99;
            gradFvsC=0.99;
        
        elseif(profile == "sin")
            Fval=1+0.5*sin(C*10);
            gradFvsC=0.5*5*cos(C*10);
        
        elseif(profile == "singrow")
            Fval=1+0.5*sin(C*10)+C/2;
            gradFvsC=0.5*5*cos(C*10)+1/2;

        % elseif(profile == "tanh")
        %     Fval=1+0.5*sin(C*10)+C/2;
        %     gradFvsC=0.5*5*cos(C*10)+1/2;
        end
end
